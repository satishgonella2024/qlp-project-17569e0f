Common utilities and helper functions